Created: 2025-09-22

Challenge Type: #Wireless_Access_Exploitation 
Challenge Difficulty: #Hard
Attachments: [[PCAP3.cap]]

WIFI PCAP 3(TODO)
Description
***
We have created a packet capture on a temporary wireless network that a couple of hackers have set up. Break into their network and see what you can learn.

Questions
***
These challenges will require a software called aircrack-ng. You can install this using.
`sudo apt install aircrack-ng`

We will also be using Wireshark, which comes default on Kali Linux

To start, we will open up the packet capture in wireshark. 
![[WIFI3-Wireshark 1.png]]
There will be a lot of encrypted traffic, but that is okay as the information we are looking for is not encrypted, allowing us to answer the first few questions.

Q1 - 5 points
What is the MAC address of the router?

This can be found by inspecting any of the packets, but the first packet will suffice. We can look into the first packet and check out the IEEE 802.11 Beacon frame section of the packet. Expand that and you should see source address. That is the MAC of the router.

Q2 - 5 points
What is the ESSID of the wifi network?

ESSID stands for Extended Service Set Identifier. This is how a device will recognize a unique network and differentiate the connection from other networks. We can find the ESSID by looking at the first packet's IEEE 802.11 Wireless Management section of the packet. We can then expand the Tagged Parameters field to find the SSID, which is what this question is asking for.

Q3 - 20 points
What is the password for the wireless network?

This is where aircrack-ng comes in to play. According to aircrack-ng man page, it has an option to crack the SSID:Password combination of a network, if that handshake is in the capture, based on a wordlist. Since this is a password cracking challenge, we can start with Rockyou

`aircrack -w "/usr/share/wordlists/rockyou.txt" -b "[Router MAC]" PCAP3.cap`

`-w`: Wordlist to try to use
`-b`: Select the target network based on the access point MAC address. (Per aircrack-ng man page)

This will take a bit, as it is hashing each rockyou password to the SSID password. Eventually, you will get some information about the network, alongside the cracked password. 
![[WIFI3-aircrack-ng output.png]]

Q4 - 10 points
What is the IP address of the router?

We can get this information by decrypting the network traffic. Go into Wireshark again with the packet capture open and go to `Edit → Preferences → Protocols → IEEE 802.11 → Decryption Keys (Edit)`
Unlike the previous challenges, you will be using the wpa-pwd key type to decrypt the traffic. Once that is entered and applied, you will now be able to view the unencrypted traffic (You will need to scroll a little bit to get to that information, or use view filters based on what you are looking for).

To get the IP of the router, we can filter our traffic based on the MAC address of our router. Go to the field you found the router MAC address in and apply it as a filter.
![[WIFI3-Wireshark 2.png]]

When you do that. Some traffic will show up with IP addresses. The first I saw was DHCP traffic that had the answer I was looking for.

![[WIFI3-Wireshark 3.png]]
Q5 - 10 points
What company manufactured the router?

You can infer this from the router SSID, but for the sake of demonstration, you can find this information by looking for a SSDP packet. You can filter for these packets by adding `and ssdp` to your filter above. Look in the SSPD field of the aforementioned packet and look at the `SERVER` field. That will give you information about that router.

Another method for finding this information is looking at TCP and HTTP packets between the user and the router. According to the traffic it looks like the user is accessing an admin panel for the router, so maybe this information is available there as well. 

Filtering for TCP or HTTP traffic `http or tcp`, we can look at the traffic and get a look at what the user is accessing.
![[WIFI3-Wireshark 4.png]]In one of the first HTTP packets that is displayed by the router, we can find the manufacturer of the router. 

Q6 - 5 points
What is the model of the router?

This information is also in the `SERVER` field of the SSDP packet. It is also in the HTTP packet we found. See Q5

Q7 - 10 points
What firmware version is installed on the router?

See Q6 and Q5

Q8 - 5 points
What release number is the router using?

This information we can also find by inspecting the HTTP traffic of the router, but it will take a little more digging. (Hint: I reccomend filtering by status code of the http request. Just right click on the packet with the status code you want and apply it to make your search easier.) The packet I found with the info I needed was a javascript output.

Q9 - 10 points
What is the IP address of the user who logged into the router admin panel?

We can simply look at the HTTP requests and see which IP was the source of any GET requests.

Q10 - 10 points
What is the MAC address of the first victim of the deauth attack?

This can be solved by applying a specific filter related to routers. This filter actually shows when the router is sending deauthentication packets. An attacker can also spoof the router's MAC address to send these packets themselves to a user to force their device to disconnect. This is a common attack method to force users to re-login to a network, giving attackers a chance to steal the network passkey/password through inspecting the handshake between the user's device and the router.
`wlan.fc.type_subtype eq 12`

When you view these packets, you can view both the source and destination MAC addresses of these packets. Youll want to look at the destination packets for this answer. 

Q11 - 10 points
What is the MAC address of the second victim of the deauth attack?

See Q 10