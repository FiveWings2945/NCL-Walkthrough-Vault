Created: 2025-09-24

Challenge Type: #Web_App_Exploitation
Challenge Difficulty: #Medium
Attachments: Metro Lottery Website

Metro Lottery
Description
***
Conduct a security audit on the city'sÂ [lottery system](https://0d13533af0ee66828b58f73165b0163a-metro-lottery.web.cityinthe.cloud/).  
  
**Note: Your scope is limited to HTTPS. You may use automated tools that make educated guesses for this challenge, blind automated brute force is not permitted.**

Questions
***
At first glance, it looks like all we have is the lottery website. When we look at the amount of money we have, we can only buy 2000 more tickets, giving us a 3.98% chance of winning. 
![[ML-Website.png]]
That is obviously not enough for us to win, so we have to figure out how to either increase our odds or get more money to buy lottery tickets. Opening up the website in Burpsuite through our [[Proxy]], it doesn't look like we have any other available endpoints, so our solution must be through this page. Lets send a request to buy some tickets and capture it through our proxy and take a look at the request parameters.
![[ML-Request.png]]

Taking a look at our request parameters, we see two that stick out to us: `cost` and `tickets`. Looks like a normal request to me. Now lets look at the request if we try to order more tickets that we should be able to.

![[ML-Too Many Tickets.png]]

Interesting! Instead of sending a POST request to the server to validate, the website performs client-sided validation. This is shown by the fact we get a JavaScript alert as opposed to seeing a post request in our proxy queue. Since this website performs client sided validation, it can be a safe assumption that it does not perform server-sided validation.

To test this, we will go back to our original POST request and try editing some of those parameters:
![[ML-Cost Edit.png]]

Here I edited the cost of the tickets, so I can buy 2000 tickets for 5 bucks. 

![[ML-Website Money Edit.png]]

As you can see, we bought an extra 2000 tickets for 5 dollars. Thats quite a deal if you ask me. You can continue to use this method if you would like, but a faster method (as there is a time limit), would be editing the amount of tickets we can buy. Lets try editing that parameter:

![[ML-Ticket Edit.png]]

Here, I edited the parameter to buy us 200 million tickets. That should be enough to guarantee us a good chance of winning

![[ML-Website Ticket Edit.png]]

Sufficed to say, I think we got this lottery win in the bag.

Q1
What is the flag obtained after winning the lottery?

Youll find it after you have successfully exploited the server side validation vulnerability.