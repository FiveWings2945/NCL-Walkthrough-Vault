Created: 2025-09-23

Challenge Type: #Web_App_Exploitation
Challenge Difficulty: #Easy 
Attachments: Never Winter Bank Website

Never Winter Bank
Description
***
You have been hired to run a pentest onÂ [this bank's old out of date system](https://0d13748cf0ee41348b58d08765b0318c-neverwinter-bank.web.cityinthe.cloud/). Can you find the vulnerability in the code and completely drain the other user's account?

Questions
***
When we first open the page, it looks like a standard send and receive website where we can transfer funds from our account to another account. 
![[NWB-Website.png]]
When we enter and amount in the transfer field, and hit transfer, we can see that money goes from one account to us. However, when we try to transfer more than we are allowed, we end up not transferring anything. 
If you experiment a little bit, we find that the maximum we can transfer is up to 990 dollars from the account. We'll find out why in a minute.

One of the first things I like to do when looking at a website with any form of backend in looking for robots.txt and seeing if we can access it. This file contains pages that the developers don't want web-scrapers/bots finding out about, and can block proper triage in tools like Burpsuite. In our case, we can access robots.txt and see a file that looks interesting:
![[NWB-Leaked File.png]]

Q1
What is the path of the leaked file?

The file we just found ended up being the leaked file that the question is referring to.


Continuing on, we take a look at this file that we found:
![[NWB-LeakFile.png]]
We see a function that looks like the transfer logic
```
// TODO auditor says something is wrong with this code....
if (parseInt(amount) < account.amount) {
  if ((account.amount - parseInt(amount)) < account.minimum) {
    return res.status(400).send('Error: Account is not allowed to have a balance lower than 10');
  }
  var transferAmount = parseInt(amount, 10);
  account.amount -= transferAmount;

}
```

Taking a look at the code, we see something interesting about the function calls to `parseint()`. Looking at the documentation of `parseint()`, we see that it can take two variables: `parseInt(string, radix)`. However, only one of those calls takes advantage of that second variable. What is important about that is that, in some older javascript distributions, the server will interpret the string based on the format that it is in. For example, if the call is made as `parseInt("5a")`, the return value will be 90, but if the call is made as `parseInt("5a", 10)`, the return value will be 5. 

What's interesting is we can use a base that is smaller than base 10 to get around the first call, but gain more money than is in the account. For example, we will take base 8 for example. According to javascript docs, we can use the prefix `0o` to signify an octal number. Unfortunatly, this wont work as the final line will interpret this as a base 10 `0`. Looking further, it does mention that just a leading zero may cause the function to parse it as a base 8 number, so it is worth looking into. If we use the input `parseInt("01000")`, the output will be 512. This will pass the first line of logic as it is less than the account amount (1000), and it will pass the second line of logic as 1000 - 512 is less than the account minimum, which we found was 10. This will then lead to the call `parseInt("01000", 10)` and that output will be 1000, clearing out the bank account.

Knowing this, lets put it into practice:

![[NWB-PreExploit.png]]
(Note: I put a number greater that 01000 to show a more obvious example of this vulnerability)

Then we can hit transfer and let the program do its magic:
![[NWB-PostExploit.png]]
And just like that, we got more money than we should have, and we got the flag as well.

Q2
What's the flag?

It will be displayed at the bottom once you have successfully exploited the vulnerability.