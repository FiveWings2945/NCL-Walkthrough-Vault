Created: 2025-09-24

Challenge Type: #Enumeration_and_Exploitation 
Challenge Difficulty: #Easy 
Attachments: Timebomb.class

Timebomb
Description
***
Reverse engineer a program to find out when it activates.

Questions
***
Q1
What programming language is the program written in?

Just taking one look at the program name and we can tell it is a java binary. 


Lets go ahead and launch Ghidra with this binary. Once we analyze it, we see two functions: `init` and `main`. Lets look at `main` since that will usually hold the meat of our code.

```java
/* Flags:
     ACC_PUBLIC
     ACC_STATIC
   
   public static void main(java.lang.String[])  */

void main_java.lang.String[]_void(String[] param1)

{
  PrintStream pPVar1;
  long lVar2;
  
  lVar2 = System.currentTimeMillis();
  if ((double)lVar2 <= 1658063520000.0) {
    pPVar1 = System.out;
    pPVar1.println("It isn\'t time yet");
    System.exit(10);
  }
  else {
    pPVar1 = System.out;
    pPVar1.println("Boom");
    System.exit(0);
  }
  return;
}
```

Lets refactor it and add some variable names

```java
/* Flags:
     ACC_PUBLIC
     ACC_STATIC
   
   public static void main(java.lang.String[])  */

void main_java.lang.String[]_void(String[] param1)

{
  long systemTime;
  PrintStream outputStream;
  
  systemTime = System.currentTimeMillis();
  if ((double)systemTime <= 1658063520000.0) {
    outputStream = System.out;
    outputStream.println("It isn\'t time yet");
    System.exit(10);
  }
  else {
    outputStream = System.out;
    outputStream.println("Boom");
    System.exit(0);
  }
  return;
}
```

Now we can take a look at what this code does:

```pseudocode
Variable declaration
Get the current time
Check if the time is less than the stated time
Else go boom
```

Now all we have to do is figure out what time it is supposed to explode.

Q2
What exit code does the program exit with when it is not time?

Check the first if statement

Q3
What time (in UTC) does the software go "Boom"?

We know that the software will explode at a system time designated by 1658063520000 milliseconds. Now what would be the starting point of this to determine when to start counting? By doing a little bit of research, we find that systems will keep time based on the "Unix Epoch", January 1<sub>st</sub>, 1970. This date was chosen by unix engineers as a convenient date to base their timekeeping on. All we have to do then is through our time into a Unix Epoch calculator and we got our answer.