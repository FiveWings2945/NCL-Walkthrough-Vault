Created: 2025-09-24

Challenge Type: #Enumeration_and_Exploitation 
Challenge Difficulty #Medium 
Attachments: Python3.pyc

Python3
Description
***
We have created a python script for you to break into as training. See if you can figure out a password that will authenticate with the program.

Questions
***
Q1
What is an input to this program that will result in a correct validation?

Taking a look at our file here, it is a pyc file. A quick google search and I found an online decompiler that will decompile pyc binaries for us. Great!
[toolnb](https://www.toolnb.com/tools-lang-en/pyc.html)
![[Python3-toolnb.png]]

Looking at the program, we have a challenge similar to that of Python1. Lets do this through scripting, because I personally want to practice it more.

Lets pull our GPT Script from Python1:
```python
from z3 import *

def crack():
    length = 10
    target_sum = 1000
    # Create 10 symbolic characters
    chars = [Int(f"c{i}") for i in range(length)]
    s = Solver()
    # ASCII range constraint
    for c in chars:
        s.add(c >= 32, c <= 126)  # printable range
    # Sum constraint
    s.add(Sum(chars) == target_sum)
    # Length fixed
    # (implicit since we made 10 vars)
    # Second character must be 'S'
    s.add(chars[1] == ord('S'))
    if s.check() == sat:
        model = s.model()
        password = ''.join(chr(model[c].as_long()) for c in chars)
        print("Found:", password)
    else:
        print("No solution")

if __name__ == "__main__":
    crack()
```

And edit it so that we can crack this program.

`length = 11`
`target_answer = 12645638`
`s.add(chars[0] == 78)`
These are our targets

`sum_chars = Sum([ZeroExt(24, c) for c in chars])`
`chars = [BitVec(f"c{i}", 8) for i in range(length)]`
To allow bitvec operations

`expr = ~((~(sum_chars << 2)) ^ BitVecVal(12648430, 32))`
Our new equation

We can edit our program to this

```python
from z3 import *

def crack():
    length = 11
    target_sum = 12645638
    # Create 10 symbolic characters
    chars = [BitVec(f"c{i}", 8) for i in range(length)]
    s = Solver()
    # ASCII range constraint
    for c in chars:
        s.add(c >= 32, c <= 126)  # printable range
    #Allowing BitVec operations
    sum_chars = Sum([ZeroExt(24, c) for c in chars])
    
    expr = ~((~(sum_chars << 2)) ^ BitVecVal(12648430, 32))
    s.add(expr == BitVecVal(target_sum, 32))
    # Length fixed
    # (implicit since we made 10 vars)
    # Second character must be 'S'
    s.add(chars[0] == 78)
    if s.check() == sat:
        model = s.model()
        password = ''.join(chr(model[c].as_long()) for c in chars)
        print("Found:", password)
    else:
        print("No solution")

if __name__ == "__main__":
    crack()
```

Running this program got me a valid password